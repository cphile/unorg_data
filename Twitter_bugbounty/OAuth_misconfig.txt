
Intro :  OAuth-based vuln. is Occurs when the configuration of the OAuth service itself enables attackers to steal authorization codes or access tokens associated with other usersâ€™ accounts.

By stealing a valid code or token, Attacker may be able to access the victim's account.


Where to find :ðŸ‘‡

â€¢ In the SSO feature. For example Log in with google or Log in with facebook.

â€¢ Try to remove email from the scope and add victim's email manually.

How to exploit ðŸ§µ:ðŸ‘‡
â€¢ Create an account with victim@gmail.com with normal functionality. Create account with victim@gmail.com using OAuth functionality. Now try to login using previous credentials.

â€¢ OAuth Token Re-use.

â€¢ Missing or broken state parameter.
Lack of origin check.

â€¢ Open Redirection on another endpoint > Use it in redirect_uri

â€¢ If there is an email parameter after signin then try to change the email parameter to victim's one.

More ðŸ§µ:ðŸ‘‡

â€¢ Only company's email is allowed? > Try to replace hd=http://company.com to hd=http://gmail.com

â€¢ Check if its leaking client_secret parameter.

â€¢ Go to the browser history and check if the token is there.
